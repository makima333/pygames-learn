## ゲーム要件定義: 3D Language Simulator

### 1. ゲーム概要
• **タイトル**: 3D Language Visual Simulator
• **ジャンル**: プログラミング言語シミュレーター/パズルゲーム
• **プラットフォーム**: Python + pygame
• **目的**: 3D言語のプログラムを視覚的に実行し、時空間の複雑さを最小化するプログラムを作成する

### 2. 核心機能

#### 2.1 コードエディタ機能
• **グリッドベースエディタ**: 2Dグリッド上でセルを編集
• **トークン入力**: 数値(-99〜99)、演算子、空セル(.)の配置
• **リアルタイム構文チェック**: 無効なトークンの検出
• **ファイル保存/読み込み**: プログラムの永続化

#### 2.2 シミュレーション実行機能
• **ステップ実行**: tick単位での実行制御
• **連続実行**: 自動実行モード
• **時間軸表示**: 現在のtick数とタイムライン
• **実行速度調整**: スローモーション〜高速実行

#### 2.3 視覚化機能
• **グリッド表示**: 2Dボードの視覚的表現
• **値の移動アニメーション**: 演算子による値の移動を滑らかに表示
• **時間旅行の可視化**: ワープ操作時の時間軸変化
• **色分け表示**:
  • 数値: 青系
  • 演算子: 赤系
  • 空セル: グレー
  • 入力値A,B: 緑系
  • 出力S: 黄系

#### 2.4 デバッグ機能
• **ブレークポイント**: 特定tick/座標での一時停止
• **変数ウォッチ**: 特定セルの値変化追跡
• **実行履歴**: 過去の状態への巻き戻し表示
• **エラー表示**: 衝突やクラッシュの詳細情報

### 3. ユーザーインターフェース

#### 3.1 メイン画面構成
• **左パネル**: コードエディタ(グリッド)
• **右パネル**: 実行制御とデバッグ情報
• **下部パネル**: ログとエラー表示
• **上部**: メニューバーとツールバー

#### 3.2 操作方法
• **マウス**: セルクリックで編集、ドラッグで範囲選択
• **キーボード**: 数値・演算子の直接入力
• **ショートカット**:
  • Space: 実行/一時停止
  • F5: リセット
  • F10: ステップ実行
  • Ctrl+S: 保存

### 4. ゲーム要素

#### 4.1 チュートリアルモード
• **基本操作**: グリッド編集、実行方法
• **演算子学習**: 各演算子の動作を段階的に学習
• **時間旅行**: ワープ操作の理解
• **最適化**: 時空間複雑度の概念

#### 4.2 チャレンジモード
• **問題集**: ICFP2024の12問題を実装
• **スコアシステム**: 時空間複雑度による採点
• **リーダーボード**: ベストスコアの記録
• **ヒント機能**: 行き詰まった時のアドバイス

#### 4.3 サンドボックスモード
• **自由編集**: 制限なしでプログラム作成
• **カスタム入力**: A,B値の自由設定
• **実験機能**: 新しいアルゴリズムの試行

### 5. 技術仕様

#### 5.1 pygame実装詳細
• **画面解像度**: 1200x800 (可変)
• **フレームレート**: 60 FPS
• **グリッドサイズ**: 可変ズーム対応
• **フォント**: 等幅フォント使用

#### 5.2 データ構造
• **ボード**: 2D辞書構造 {(x,y): value}
• **履歴**: 各tickの状態を保存
• **時間軸**: タイムスタンプ付きイベントキュー

#### 5.3 パフォーマンス要件
• **最大グリッドサイズ**: 100x100
• **最大tick数**: 1,000,000
• **メモリ使用量**: 512MB以下
• **応答性**: UI操作は16ms以内

### 6. 拡張機能

#### 6.1 エクスポート機能
• **GIF動画**: 実行過程のアニメーション出力
• **ステップ画像**: 各tickのスクリーンショット
• **統計データ**: CSV形式での実行データ

#### 6.2 共有機能
• **プログラム共有**: コードのエクスポート/インポート
• **解法投稿**: コミュニティでの解法共有

この要件定義に基づいて、段階的に実装を進めることをお勧めします。まずは基本的なグリッドエディタとシンプルな実行機能
から始めて、徐々に高度な機能を追加していく形が良いでしょう。
